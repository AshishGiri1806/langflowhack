import{r as i,C as le,A as ne,j as e,B as M,$ as ce,a as _,b,c as T,d as F,E as J,e as K,f as X,g as de,n as oe,u as Q,h as me,i as Y,I as U,k as xe,l as ue,L as he,S as B,m as pe,U as fe,o as je,p as O,q as W,s as q,t as Z,v as ve,w as ge,x as Ce}from"./index-e8QJh9aC.js";import{H as Ne}from"./index-Bqc2ZDao.js";import{P as we}from"./index-BnDyGww4.js";import{C as ee,a as se}from"./checkbox-C_SFShR-.js";import{I as Se}from"./input-CR-TkjST.js";import{T as Ee,a as _e,b as te,c as C,d as be,e as N}from"./table-8lEBUpUR.js";import{C as m}from"./index-CrI-hm3S.js";import"./popover-eZMmjMhl.js";import"./index-BarjJ5Aq.js";import"./index-ZHR7F3ag.js";import"./index-D7j--BBS.js";import"./label-DasAbf65.js";import"./shortcuts-CMLmoE4H.js";import"./index-Dp3cEFDe.js";function ae({title:y,titleHeader:R,cancelText:A,confirmationText:D,children:I,icon:k,data:a,index:h,onConfirm:p,asChild:f}){const z=oe[k],[j,w]=i.useState(!1),[v,d]=i.useState(!1),[P,o]=i.useState(!1),[x,$]=i.useState((a==null?void 0:a.password)??""),[u,L]=i.useState((a==null?void 0:a.username)??""),[g,H]=i.useState((a==null?void 0:a.password)??""),[S,V]=i.useState((a==null?void 0:a.is_active)??!1),[E,s]=i.useState((a==null?void 0:a.is_superuser)??!1),[t,r]=i.useState(le),{userData:n}=i.useContext(ne);function c({target:{name:l,value:ie}}){r(re=>({...re,[l]:ie}))}i.useEffect(()=>{a?(c({target:{name:"username",value:u}}),c({target:{name:"is_active",value:S}}),c({target:{name:"is_superuser",value:E}})):G()},[P]);function G(){$(""),L(""),H("")}return e.jsxs(M,{size:"medium-h-full",open:P,setOpen:o,children:[e.jsx(M.Trigger,{asChild:f,children:I}),e.jsxs(M.Header,{description:R,children:[e.jsx("span",{className:"pr-2",children:y}),e.jsx(z,{name:"icon",className:"h-6 w-6 pl-1 text-foreground","aria-hidden":"true"})]}),e.jsx(M.Content,{children:e.jsxs(ce,{onSubmit:l=>{if(x!==g){l.preventDefault();return}G(),p(1,t),o(!1),l.preventDefault()},children:[e.jsxs("div",{className:"grid gap-5",children:[e.jsxs(_,{name:"username",children:[e.jsx("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-between"},children:e.jsxs(b,{className:"data-[invalid]:label-invalid",children:["Username"," ",e.jsx("span",{className:"font-medium text-destructive",children:"*"})]})}),e.jsx(T,{asChild:!0,children:e.jsx("input",{onChange:({target:{value:l}})=>{c({target:{name:"username",value:l}}),L(l)},value:u,className:"primary-input",required:!0,placeholder:"Username"})}),e.jsx(F,{match:"valueMissing",className:"field-invalid",children:"Please enter your username"})]}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx("div",{className:"mr-3 basis-1/2",children:e.jsxs(_,{name:"password",serverInvalid:x!=g,children:[e.jsx("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-between"},children:e.jsxs(b,{className:"data-[invalid]:label-invalid flex",children:["Password"," ",e.jsx("span",{className:"ml-1 mr-1 font-medium text-destructive",children:"*"}),j&&e.jsx(J,{onClick:()=>w(!j),className:"h-5 cursor-pointer",strokeWidth:1.5}),!j&&e.jsx(K,{onClick:()=>w(!j),className:"h-5 cursor-pointer",strokeWidth:1.5})]})}),e.jsx(T,{asChild:!0,children:e.jsx("input",{onChange:({target:{value:l}})=>{c({target:{name:"password",value:l}}),$(l)},value:x,className:"primary-input",required:!a,type:j?"text":"password"})}),e.jsx(F,{className:"field-invalid",match:"valueMissing",children:"Please enter a password"}),x!=g&&e.jsx(F,{className:"field-invalid",children:"Passwords do not match"})]})}),e.jsx("div",{className:"basis-1/2",children:e.jsxs(_,{name:"confirmpassword",serverInvalid:x!=g,children:[e.jsx("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-between"},children:e.jsxs(b,{className:"data-[invalid]:label-invalid flex",children:["Confirm password"," ",e.jsx("span",{className:"ml-1 mr-1 font-medium text-destructive",children:"*"}),v&&e.jsx(J,{onClick:()=>d(!v),className:"h-5 cursor-pointer",strokeWidth:1.5}),!v&&e.jsx(K,{onClick:()=>d(!v),className:"h-5 cursor-pointer",strokeWidth:1.5})]})}),e.jsx(T,{asChild:!0,children:e.jsx("input",{onChange:l=>{H(l.target.value)},value:g,className:"primary-input",required:!a,type:v?"text":"password"})}),e.jsx(F,{className:"field-invalid",match:"valueMissing",children:"Please confirm your password"})]})})]}),e.jsxs("div",{className:"flex gap-8",children:[e.jsx(_,{name:"is_active",children:e.jsxs("div",{children:[e.jsx(b,{className:"data-[invalid]:label-invalid mr-3",children:"Active"}),e.jsx(T,{asChild:!0,children:e.jsx(ee,{value:S,checked:S,id:"is_active",className:"relative top-0.5",onCheckedChange:l=>{c({target:{name:"is_active",value:l}}),V(l)}})})]})}),(n==null?void 0:n.is_superuser)&&e.jsx(_,{name:"is_superuser",children:e.jsxs("div",{children:[e.jsx(b,{className:"data-[invalid]:label-invalid mr-3",children:"Superuser"}),e.jsx(T,{asChild:!0,children:e.jsx(ee,{checked:E,value:E,id:"is_superuser",className:"relative top-0.5",onCheckedChange:l=>{c({target:{name:"is_superuser",value:l}}),s(l)}})})]})})]})]}),e.jsxs("div",{className:"float-right",children:[e.jsx(X,{variant:"outline",onClick:()=>{o(!1)},className:"mr-3",children:A}),e.jsx(de,{asChild:!0,children:e.jsx(X,{className:"mt-8",children:D})})]})]})})]})}function Oe(){const[y,R]=i.useState(""),[A,D]=i.useState(10),[I,k]=i.useState(1),[a,h]=i.useState(!0),p=Q(s=>s.setSuccessData),f=Q(s=>s.setErrorData),{userData:z}=i.useContext(ne),[j,w]=i.useState(0),v=me(s=>s.setCurrentFlowId);i.useEffect(()=>{v("")},[]);const d=i.useRef([]);i.useEffect(()=>{setTimeout(()=>{x()},500)},[]);const[P,o]=i.useState(d.current);function x(){h(!0),Y(I-1,A).then(s=>{w(s.total_count),d.current=s.users,o(s.users),h(!1)}).catch(s=>{h(!1)})}function $(s,t){h(!0),D(t),k(s),Y(t*(s-1),t).then(r=>{w(r.total_count),d.current=r.users,o(r.users),h(!1)}).catch(r=>{h(!1)})}function u(){k(1),D(10),x()}function L(s){if(R(s),s==="")o(d.current);else{const t=d.current.filter(r=>r.username.toLowerCase().includes(s.toLowerCase()));o(t)}}function g(s){pe(s.id).then(t=>{u(),p({title:fe})}).catch(t=>{f({title:je,list:[t.response.data.detail]})})}function H(s,t){O(s,t).then(r=>{u(),p({title:W})}).catch(r=>{f({title:q,list:[r.response.data.detail]})})}function S(s,t,r){const n=Z.cloneDeep(r);n.is_active=!s,O(t,n).then(c=>{u(),p({title:W})}).catch(c=>{f({title:q,list:[c.response.data.detail]})})}function V(s,t,r){const n=Z.cloneDeep(r);n.is_superuser=!s,O(t,n).then(c=>{u(),p({title:W})}).catch(c=>{f({title:q,list:[c.response.data.detail]})})}function E(s){ve(s).then(t=>{O(t.id,{is_active:s.is_active,is_superuser:s.is_superuser}).then(r=>{u(),p({title:ge})})}).catch(t=>{f({title:Ce,list:[t.response.data.detail]})})}return e.jsxs(e.Fragment,{children:[e.jsx(Ne,{}),z&&e.jsxs("div",{className:"admin-page-panel flex h-full flex-col pb-8",children:[e.jsx("div",{className:"main-page-nav-arrangement",children:e.jsxs("span",{className:"main-page-nav-title",children:[e.jsx(U,{name:"Shield",className:"w-6"}),xe]})}),e.jsx("span",{className:"admin-page-description-text",children:ue}),e.jsxs("div",{className:"flex w-full justify-between px-4",children:[e.jsxs("div",{className:"flex w-96 items-center gap-4",children:[e.jsx(Se,{placeholder:"Search Username",value:y,onChange:s=>L(s.target.value)}),y.length>0?e.jsx("div",{className:"cursor-pointer",onClick:()=>{R(""),o(d.current)},children:e.jsx(U,{name:"X",className:"w-6 text-foreground"})}):e.jsx("div",{children:e.jsx(U,{name:"Search",className:"w-6 text-foreground"})})]}),e.jsx("div",{children:e.jsx(ae,{title:"New User",titleHeader:"Add a new user",cancelText:"Cancel",confirmationText:"Save",icon:"UserPlus2",onConfirm:(s,t)=>{E(t)},asChild:!0,children:e.jsx(X,{variant:"primary",children:"New User"})})})]}),a?e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsx(he,{remSize:12})}):d.current.length===0?e.jsx(e.Fragment,{children:e.jsx("div",{className:"m-4 flex items-center justify-between text-sm",children:"No users registered."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"m-4 h-full overflow-x-hidden overflow-y-scroll rounded-md border-2 bg-background custom-scroll"+(a?" border-0":""),children:e.jsxs(Ee,{className:"table-fixed outline-1",children:[e.jsx(_e,{className:a?"hidden":"table-fixed bg-muted outline-1",children:e.jsxs(te,{children:[e.jsx(C,{className:"h-10",children:"Id"}),e.jsx(C,{className:"h-10",children:"Username"}),e.jsx(C,{className:"h-10",children:"Active"}),e.jsx(C,{className:"h-10",children:"Superuser"}),e.jsx(C,{className:"h-10",children:"Created At"}),e.jsx(C,{className:"h-10",children:"Updated At"}),e.jsx(C,{className:"h-10 w-[100px] text-right"})]})}),!a&&e.jsx(be,{children:P.map((s,t)=>e.jsxs(te,{children:[e.jsx(N,{className:"truncate py-2 font-medium",children:e.jsx(B,{content:s.id,children:e.jsx("span",{className:"cursor-default",children:s.id})})}),e.jsx(N,{className:"truncate py-2",children:e.jsx(B,{content:s.username,children:e.jsx("span",{className:"cursor-default",children:s.username})})}),e.jsx(N,{className:"relative left-1 truncate py-2 text-align-last-left",children:e.jsxs(m,{size:"x-small",title:"Edit",titleHeader:`${s.username}`,modalContentTitle:"Attention!",cancelText:"Cancel",confirmationText:"Confirm",icon:"UserCog2",data:s,index:t,onConfirm:(r,n)=>{S(n.is_active,n.id,n)},children:[e.jsx(m.Content,{children:e.jsx("span",{children:"Are you completely confident about the changes you are making to this user?"})}),e.jsx(m.Trigger,{children:e.jsx("div",{className:"flex w-fit",children:e.jsx(se,{checked:s.is_active})})})]})}),e.jsx(N,{className:"relative left-1 truncate py-2 text-align-last-left",children:e.jsxs(m,{size:"x-small",title:"Edit",titleHeader:`${s.username}`,modalContentTitle:"Attention!",cancelText:"Cancel",confirmationText:"Confirm",icon:"UserCog2",data:s,index:t,onConfirm:(r,n)=>{V(n.is_superuser,n.id,n)},children:[e.jsx(m.Content,{children:e.jsx("span",{children:"Are you completely confident about the changes you are making to this user?"})}),e.jsx(m.Trigger,{children:e.jsx("div",{className:"flex w-fit",children:e.jsx(se,{checked:s.is_superuser})})})]})}),e.jsx(N,{className:"truncate py-2",children:new Date(s.create_at).toISOString().split("T")[0]}),e.jsx(N,{className:"truncate py-2",children:new Date(s.updated_at).toISOString().split("T")[0]}),e.jsx(N,{className:"flex w-[100px] py-2 text-right",children:e.jsxs("div",{className:"flex",children:[e.jsx(ae,{title:"Edit",titleHeader:`${s.id}`,cancelText:"Cancel",confirmationText:"Save",icon:"UserPlus2",data:s,index:t,onConfirm:(r,n)=>{H(s.id,n)},children:e.jsx(B,{content:"Edit",side:"top",children:e.jsx(U,{name:"Pencil",className:"h-4 w-4 cursor-pointer"})})}),e.jsxs(m,{size:"x-small",title:"Delete",titleHeader:"Delete User",modalContentTitle:"Attention!",cancelText:"Cancel",confirmationText:"Delete",icon:"UserMinus2",data:s,index:t,onConfirm:(r,n)=>{g(n)},children:[e.jsx(m.Content,{children:e.jsx("span",{children:"Are you sure you want to delete this user? This action cannot be undone."})}),e.jsx(m.Trigger,{children:e.jsx(U,{name:"Trash2",className:"ml-2 h-4 w-4 cursor-pointer"})})]})]})})]},t))})]})}),e.jsx(we,{pageIndex:I,pageSize:A,totalRowsCount:j,paginate:(s,t)=>{$(t,s)}})]})]})]})}export{Oe as default};
