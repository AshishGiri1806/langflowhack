import{af as h,r as a,A as te,u as se,h as _,au as ae,y as le,bq as K,br as oe,bs as re,bt as ne,bu as ie,bv as de,j as e,bw as ce,bx as ue,f as pe,aw as me,I as L,t as O,S as xe,bj as he,av as ge}from"./index-e8QJh9aC.js";import{I as fe,C as be,S as C}from"./index-BYkvTyAV.js";import{P as je}from"./index-CCEUNqLA.js";import{P as Se}from"./index-BnDyGww4.js";import{T as ve}from"./index-u77YwG8w.js";import{S as V,f as z,g as B,h as D,i as we,j as u}from"./table-8lEBUpUR.js";import"./index-CveeD_kd.js";import"./index-BarjJ5Aq.js";import"./index-ZHR7F3ag.js";import"./index-Cc8e4Dig.js";import"./input-CR-TkjST.js";import"./index-CgG8jb4E.js";import"./popover-eZMmjMhl.js";import"./index-DMsDFRUG.js";import"./label-DasAbf65.js";import"./index-DU-McIir.js";import"./checkbox-C_SFShR-.js";import"./form-Bg8t85Kg.js";import"./index-Bqc2ZDao.js";import"./index-D7j--BBS.js";import"./shortcuts-CMLmoE4H.js";import"./index-BgPOWpTS.js";import"./index-Dp3cEFDe.js";function Ue(){const c=h(t=>t.hasApiKey),l=h(t=>t.validApiKey),p=h(t=>t.loadingApiKey),g=h(t=>t.updateValidApiKey),{apiKey:q}=a.useContext(te),f=se(t=>t.setErrorData),M=_(t=>t.setCurrentFlowId),G=_(t=>t.currentFlowId),[s,m]=a.useState(!0),[Y,b]=a.useState(!0),{id:x}=ae(),[i,U]=a.useState([]),[j,X]=a.useState(""),[r,N]=a.useState([]),[S,A]=a.useState(0),[v,T]=a.useState(12),[w,E]=a.useState(1),[I,$]=a.useState("Popular"),[H,J]=a.useState([]),[n,y]=a.useState("All"),[Q,P]=a.useState(""),[d,R]=a.useState("all"),W=le();a.useEffect(()=>{p||(c?l||f({title:K,list:[re]}):(f({title:K,list:[oe]}),m(!1)))},[p,l,c,G]),a.useEffect(()=>{Z(),ee()},[n,I,w,v,i,d,l,c,q,Q,p,x]);function Z(){b(!0),ne().then(t=>{J(t),b(!1)}).catch(t=>{console.log(t),b(!1)})}function ee(){p||(m(!0),ie({component_id:x,page:w,limit:v,is_component:n==="All"?null:n!=="Flows",sort:I==="Popular"?"-count(downloads)":"name",tags:i,liked:d==="likedbyme"&&l?!0:null,isPrivate:null,search:j===""?null:j,filterByUser:d==="createdbyme"&&l?!0:null}).then(t=>{var o;!(t!=null&&t.authorized)&&l===!0?(g(!1),R("all")):(t!=null&&t.authorized&&g(!0),m(!1),N((t==null?void 0:t.results)??[]),A((i==null?void 0:i.length)===0?Number((t==null?void 0:t.count)??0):((o=t==null?void 0:t.results)==null?void 0:o.length)??0))}).catch(t=>{var o,k;((o=t.response)==null?void 0:o.status)===403||((k=t.response)==null?void 0:k.status)===401?g(!1):(N([]),A(0),m(!1),f({title:de,list:[t.response.data.detail]}))}))}a.useEffect(()=>{M("")},[]);function F(){E(1),T(12)}return e.jsx(je,{betaIcon:!0,title:ce,description:ue,button:e.jsxs(pe,{"data-testid":"api-key-button-store",disabled:s,className:me(`${l?"":"animate-pulse border-error"}`,s?"cursor-not-allowed":""),variant:"primary",onClick:()=>{W("/settings/general/api")},children:[e.jsx(L,{name:"Key",className:"mr-2 w-4"}),"API Key"]}),children:e.jsxs("div",{className:"flex h-full w-full flex-col justify-between",children:[e.jsxs("div",{className:"flex w-full flex-col gap-4 p-0",children:[e.jsxs("div",{className:"flex items-end gap-4",children:[e.jsx(fe,{loading:s,divClasses:"relative h-12 w-[40%]",value:j,onChange:t=>X(t.target.value),onKeyDown:t=>{t.key==="Enter"&&P(O.uniqueId())},onClick:()=>{P(O.uniqueId())}}),e.jsxs("div",{className:"ml-4 flex w-full gap-2 border-b border-border",children:[e.jsx("button",{"data-testid":"all-button-store",disabled:s,onClick:()=>{y("All")},className:(n==="All"?"border-b-2 border-primary p-3":"border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed":""),children:"All"}),e.jsx("button",{"data-testid":"flows-button-store",disabled:s,onClick:()=>{F(),y("Flows")},className:(n==="Flows"?"border-b-2 border-primary p-3":"border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed":""),children:"Flows"}),e.jsx("button",{"data-testid":"components-button-store",disabled:s,onClick:()=>{F(),y("Components")},className:(n==="Components"?"border-b-2 border-primary p-3":"border-b-2 border-transparent p-3 text-muted-foreground hover:text-primary")+(s?" cursor-not-allowed":""),children:"Components"}),e.jsx(xe,{content:"Coming Soon",children:e.jsx("button",{className:"cursor-not-allowed p-3 text-muted-foreground",children:"Bundles"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(V,{disabled:s,onValueChange:R,value:d,children:[e.jsx(z,{className:"mr-4 w-[160px] flex-shrink-0",children:e.jsx(B,{placeholder:"Filter Values"})}),e.jsx(D,{children:e.jsxs(we,{children:[e.jsx(u,{value:"all",children:"All"}),e.jsx(u,{disabled:!c||!l,value:"createdbyme",children:"Created By Me"}),e.jsx(u,{disabled:!c||!l,value:"likedbyme",children:"Liked By Me"})]})})]}),x===void 0?e.jsx(ve,{tags:H,loadingTags:Y,disabled:s,selectedTags:i,setSelectedTags:U}):e.jsxs(he,{variant:"outline",size:"sq",className:"gap-2 bg-beta-foreground text-background hover:bg-beta-foreground",children:[e.jsx(ge,{to:"/store",className:"cursor-pointer",children:e.jsx(L,{name:"X",className:"h-4 w-4"})}),x]},"id")]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsx("span",{className:"px-0.5 text-sm text-muted-foreground",children:(!s||r.length!==0)&&e.jsxs(e.Fragment,{children:[S," ",S!==1?"results":"result"]})}),e.jsxs(V,{disabled:s,onValueChange:t=>{$(t)},children:[e.jsx(z,{"data-testid":"select-order-store",children:e.jsx(B,{placeholder:"Popular"})}),e.jsxs(D,{children:[e.jsx(u,{value:"Popular",children:"Popular"}),e.jsx(u,{value:"Alphabetical",children:"Alphabetical"})]})]})]}),e.jsx("div",{className:"grid w-full gap-4 md:grid-cols-2 lg:grid-cols-3",children:!s||r.length!==0?r.map(t=>{var o;return e.jsx(e.Fragment,{children:e.jsx(be,{data:t,authorized:l,disabled:s,playground:((o=t.last_tested_version)==null?void 0:o.includes("1.0.0"))&&!t.is_component},t.id)})}):e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsx(C,{}),e.jsx(C,{})]})}),!s&&(r==null?void 0:r.length)===0&&e.jsx("div",{className:"mt-6 flex w-full items-center justify-center text-center",children:e.jsx("div",{className:"flex h-full w-full flex-col",children:e.jsx("div",{className:"flex w-full flex-col gap-4",children:e.jsx("div",{className:"grid w-full gap-4",children:d!="all"?e.jsxs(e.Fragment,{children:["You haven't"," ",d==="createdbyme"?"created":"liked"," ","anything with the selected filters yet."]}):e.jsxs(e.Fragment,{children:["There are no"," ",n=="Flows"?"Flows":"Components"," with the selected filters."]})})})})})]}),!s&&r.length>0&&e.jsx("div",{className:"relative py-6",children:e.jsx(Se,{storeComponent:!0,pageIndex:w,pageSize:v,totalRowsCount:S,paginate:(t,o)=>{E(o),T(t)}})})]})})}export{Ue as default};
